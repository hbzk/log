<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="format-detection" content="telephone=no" />
<meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=medium-dpi" />
<link rel="stylesheet" href="font/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="css/lineconStyle.css">
<link rel="stylesheet" href="css/common_font.css">
<link rel="stylesheet" href="css/result.css">

<script type="text/javascript" src="js/jquery-1.11.1.min.js"></script>
<script type="text/javascript" src="js/jquery.touchSwipe.js"></script>
<script type="text/javascript" src="js/jquery.drawDoughnutChart.js"></script>
<script type="text/javascript" src="js/kakao-1.0.9.js"></script>
<script type="text/javascript" src="js/line-button.js"></script>
<script type="text/javascript" src="js/sha1.js"></script>
<script type="text/javascript" src="js/setting.js"></script>
<script type="text/javascript" src="js/result.js"></script>
<script type="text/javascript" src="js/sns.js"></script>
<title>Result</title>
<style type="text/css">
#share { position: absolute; top: 355px; right: 10px; width: 40px; height: 45px; z-index: 9; 
opacity: 0.35;}
#shareDiv {  position: absolute; bottom: 10%; width: 100%; 
text-align: center; }
#shareDiv a { width: 40px; height: 40px; display: inline-block; background: #fff;
margin: 0 1.5%; box-shadow: 2px 2px 7px #bbb; border-radius: 5px;}
#shareDiv img { width: 40px; height: 40px; }
</style>
</head>

<body>

<div class="header" data-role="header"><a class="mainLink" onclick="location.href='main.html';">&lt;</a><p>LOG Result</p></div>
<div id="date">
	<span class="left">&lt;</span><span class="right">&gt;</span>
	<p id="stDt"></p>
</div>

<section id="layout">
<div id="rtScroll">
	<p id="description"></p>
	<div id="resultList"></div>
	<div id="chart"></div>
</div>
</section>

<div class="random" onclick="location.href='other_people.html';">?</div>
<div id="type">CHART</div>

<img id="share" src="icon/sh-transparent.png" style="display: none;">

<div id="shareDiv" style="display: none;"><!-- style="display: none;"-->
	<a id="facebook" target="_blank"><img src="icon/f-Facebook.png"></a>
	<a id="twitter" target="_blank"><img src="icon/t-twitter.png"></a>
	<a id="kakaotalk" href="javascript:;"><img src="icon/k-kakao.png"></a>
	<a id="line" target="_blank"><img src="icon/line.png"></a>
</div>

<div class="range listNavi">
	<div id="day" class="dateNavi">1D</div>
 	<div id="week" class="weekNavi">1W</div>
	<div id="month" class="monthNavi">1M</div>
</div>


</body>





<script type="text/javascript">
var shareHide = true;
var nonHref = true;
var txt = 'semiLog';

var baseUrl = 'http://'+serverUrl+':2222/sns/snsResult.jsp?p=';
var facebookUrl = 'http://www.facebook.com/sharer/sharer.php?u=';
var twitterUrl = 'http://twitter.com/intent/tweet?text=' + txt + '&url=';
var lineUrl = 'http://line.me/R/msg/text/?';

function makeHref() {
	if (nonHref) {
		var period = $('#stDt').text();
		var urlParam = SHA1(userNo + new Date());
		
		$.post('http://'+serverUrl+':1111/snsShare', {urlParam: urlParam, scope: scope, period: period, result: result})
		.done(function(insertId) {
			console.log(insertId);
			if (insertId != '') {
				$('#facebook').attr('href', facebookUrl + baseUrl + urlParam);
				$('#twitter').attr('href', twitterUrl + baseUrl + urlParam);
				$('#line').attr('href', lineUrl + encodeURIComponent(baseUrl) + urlParam);
				
				// 카카오톡 링크 버튼을 생성. 처음 한번만 호출
				Kakao.Link.createTalkLinkButton({
					  container: '#kakaotalk',
					  label: 'semiLog',
					  image: {
					    src: 'http://'+serverUrl+':2222/sns/img/semiLog_logo.png',
					    width: '100',
					    height: '100'
					  },
					  webButton: {
					    text: 'semiLog',
					    url: 'http://'+serverUrl+':2222/sns/snsResult.jsp?p=' + urlParam // kakao dev에 등록한 도메인의 URL이어야 함
					  }
				});
				$('#line>span').html('<script type="text/javascript"> new media_line_me.LineButton({"pc":true,"true":"kr","type":"d","text":"http://'+serverUrl+':2222/sns/snsResult.jsp","withUrl":false})');
			}
			nonHref = false;
		});
		
		
	}	
}

$(function(){
	$('body').on('click', '#share', function(){
		if (shareHide) { // 숨김 상태일때 
			$('#shareDiv').fadeToggle(1000); shareHide = false;
			makeHref();
		}
		else { 
			$('#shareDiv').fadeToggle(400); shareHide = true;
		}
	})
	
});


$('#shareDiv').on('click', 'a', function(e) {
	var sns = e.currentTarget.id;
	
	// 모바일 아니면서
	var isMobile = (navigator.userAgent.match(/(android)|(iphone)|(ipod)|(ipad)/i));
	if(!isMobile) {
		// 페북이나 트위터가 아니면
		if (sns!='facebook' && sns!='twitter') {
		e.preventDefault();
		alert('이 기능은 모바일에서만 사용할 수 있습니다.');
		}
	}
});



// ------------------- 카카오 Link
//사용할 앱의 Javascript 키 설정
Kakao.init('	');


</script>
</html>